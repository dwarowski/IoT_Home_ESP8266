# Умный Дом на ESP8266 с MQTT

Этот проект предназначен для управления умным домом с использованием микроконтроллера ESP8266 и протокола MQTT. Проект включает в себя несколько датчиков и исполнительных устройств, таких как датчики температуры, влажности, газа, движения, а также устройства для управления освещением, окнами, кондиционером и вентиляцией.

## Описание

В данном проекте используется ESP8266 для сбора данных с различных датчиков и отправки их на MQTT-брокер. Также микроконтроллер управляет исполнительными устройствами, такими как лампы, кондиционер и окна, в зависимости от состояния датчиков или команд с MQTT-сервера.

### Подключенные устройства

- **Датчики:**
  - Датчик температуры и влажности (DHT11)
  - Датчик движения
  - Датчик газа
  - Датчик яркости (света)
  - Датчик протечки воды

- **Исполнительные устройства:**
  - Освещение
  - Уличное освещение
  - Окна (сервопривод)
  - Вытяжка
  - Кондиционер

## Требования

- **Библиотеки:**
  - `PubSubClient` для работы с MQTT
  - `DHT` для работы с датчиком температуры и влажности
  - `Servo` для управления сервоприводом
  - `ESP8266WiFi` для подключения к Wi-Fi сети

- **Микроконтроллер:**
  - ESP8266

- **MQTT-брокер:**
  - Для работы с проектом необходимо настроить MQTT-сервер. Используемый брокер — `wqtt.ru`, но можно заменить его на любой другой сервер MQTT.

## Подключение

1. **Подключите ESP8266 к Wi-Fi.**
2. **Подключите датчики и исполнительные устройства к пинам ESP8266 в соответствии с определениями в коде.**
3. **Настройте параметры подключения к Wi-Fi и MQTT-серверу в коде:**
    ```cpp
    const char *ssid = "WiFi Name"; // Имя сети Wi-Fi
    const char *pass = "Password";  // Пароль сети Wi-Fi

    const char *mqtt_server = "server.wqtt.ru";   // Адрес MQTT-сервера
    const int   mqtt_port = 12345;                // Порт MQTT-сервера
    const char *mqtt_user = "Login";              // Логин для подключения
    const char *mqtt_pass = "Password";           // Пароль для подключения
    ```

4. **Загрузите код на ESP8266 и подключитесь к MQTT-брокеру.**

## Логика работы

- **Датчики:**
  - Датчики собирают данные о температуре, влажности, движении, уровне газа, яркости и протечке воды.
  - Эти данные отправляются на сервер MQTT, где они могут быть использованы для дальнейшего анализа или визуализации.

- **Управление устройствами:**
  - Освещение включается или выключается в зависимости от датчика движения и уровня света.
  - Уличное освещение регулируется в зависимости от яркости внешнего освещения.
  - Окна управляются в зависимости от уровня влажности.
  - Вытяжка включается или выключается в зависимости от уровня влажности.
  - Кондиционер включается или выключается в зависимости от температуры.

- **Охрана:**
  - В случае активации системы охраны, движения и другие события отслеживаются, и при необходимости отправляется сигнал тревоги.

## Структура кода

1. **WiFi_Connecting** — подключение к Wi-Fi.
2. **MQTT_Connecting** — подключение к MQTT-брокеру.
3. **Read_Sensors** — считывание данных с датчиков.
4. **Publish_To_Server** — отправка данных на сервер.
5. **callback** — обработка сообщений от клиента MQTT.
6. **Lights_Logic** — управление освещением.
7. **Outside_Light_Logic** — управление уличным освещением.
8. **Window_Logic** — управление окнами.
9. **Airing_Logic** — управление вытяжкой.
10. **AC_Logic** — управление кондиционером.
11. **Fire_Logic** — обработка сигналов от датчика газа.
12. **Water_Logic** — обработка сигналов от датчика воды.
13. **Security_Logic** — логика безопасности.

## Установка и настройка

1. Установите необходимые библиотеки через Arduino IDE.
2. Настройте параметры подключения к Wi-Fi и MQTT-серверу в коде.
3. Подключите ESP8266 к компьютеру и загрузите код.
4. Используйте MQTT-клиент для отправки и получения данных с устройства.

## Контрибуция

Если у вас есть предложения по улучшению проекта, пожалуйста, откройте issue или создайте pull request.

## Лицензия

Этот проект лицензирован под MIT License - см. файл [LICENSE](LICENSE) для подробностей.

